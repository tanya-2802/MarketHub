{% extends 'base.html' %}
{% block title %}
Market Page
{% endblock %}
{% block content %}

<div class="container mt-4">

   <!-- Available Items -->
   <h2 class="mb-3">Available Items</h2>
   <p class="text-muted">Browse the market and purchase items</p>
   <div class="row">
      {% for item in items %}
      {% include 'includes/items_modals.html' %}
      <div class="col-md-4 mb-4">
         <div class="card shadow-sm bg-dark text-light h-100">
            <img src="{{ item.image_url }}" class="card-img-top" alt="{{ item.name }}">
            <div class="card-body d-flex flex-column">
               <h5 class="card-title">{{ item.name }}</h5>
               <p class="card-text text-muted">{{ item.description[:100] }}...</p>
               <p class="card-text"><strong>₹{{ item.price }}</strong></p>
               <div class="mt-auto">
                  <button class="btn btn-info btn-sm" data-toggle="modal" data-target="#Modal-MoreInfo-{{ item.id }}">
                     More Info
                  </button>
                  <button class="btn btn-success btn-sm" data-toggle="modal" data-target="#Modal-PurchaseConfirm-{{ item.id }}">
                     Buy
                  </button>
               </div>
            </div>
         </div>
      </div>
      {% endfor %}
   </div>

   <!-- Owned Items -->
   <h2 class="mt-5">Your Owned Items</h2>
   <p class="text-muted">Items you purchased (you can sell them back)</p>
   <div class="row">
      {% for owned_item in owned_items %}
      {% include 'includes/owned_items_modals.html' %}
      <div class="col-md-4 mb-4">
         <div class="card shadow-sm bg-secondary text-light h-100">
            <img src="{{ owned_item.image_url }}" class="card-img-top" alt="{{ owned_item.name }}">
            <div class="card-body d-flex flex-column">
               <h5 class="card-title">{{ owned_item.name }}</h5>
               <p class="card-text">{{ owned_item.description[:80] }}...</p>
               <p class="card-text"><strong>₹{{ owned_item.price }}</strong></p>
               <div class="mt-auto">
                  <button class="btn btn-warning btn-sm" data-toggle="modal" data-target="#Modal-SellingConfirm-{{ owned_item.id }}">
                     Sell
                  </button>
               </div>
            </div>
         </div>
      </div>
      {% endfor %}
   </div>

</div>
{% endblock %}
